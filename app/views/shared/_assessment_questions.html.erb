<% # Displays a summary of assessment questions and responses to them. %>

<% assessment_questions.order(:index).each do |question| %>
  <% response = entity.assessment_question_responses.where(assessment_question_id: question.id).first %>
  <dt class="depth-<%= depth %>"><%= question.name %></dt>
  <dd class="depth-<%= depth %>">
    <ul>
      <% question.assessment_question_options.each do |option| %>
        <%
        class_ = ''
        if response and response.assessment_question_option and
                option.id == response.assessment_question_option.id
          class_ = 'selected ' + bootstrap_fg_class_for_score(
                  response.assessment_question_option.value)
        end
        %>
        <li class="<%= class_ %>">
          <%= option.name %> <small>(<%= (option.value * 100).round %>)</small>
        </li>
      <% end %>
    </ul>
  </dd>
  <%= render partial: 'shared/assessment_questions',
             locals: { entity: entity,
                       assessment_questions: question.children,
                       depth: depth + 1 } if question.children.any? %>
<% end %>
