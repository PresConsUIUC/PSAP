<% provide(:title, 'Users') %>

<h1>Users</h1>

<%= will_paginate %>

<table class="table table-striped table-hover">
  <thead>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th>Username</th>
    <th>Name</th>
    <th>Institution</th>
  </thead>
  <tbody>
  <% @users.each do |user| %>
      <tr>
        <td>
          <% if current_user.is_admin? || current_user == user %>
              <%= link_to 'Edit', edit_user_path(user) %>
          <% end %>
        </td>
        <td>
          <% if current_user.is_admin? && !current_user?(user) %>
              <% if user.enabled %>
                  <%= link_to 'Disable', disable_user_path(user), method: :patch %>
              <% else %>
                  <%= link_to 'Enable', enable_user_path(user), method: :patch %>
              <% end %>
          <% end %>
        </td>
        <td>
          <% if current_user.is_admin? && !current_user?(user) %>
              <%= link_to 'Delete', user, method: :delete,
                          data: { confirm: 'Are you sure?' } %>
          <% end %>
        </td>
        <td><%= gravatar_for user, size: 52 %></td>
        <td><%= link_to user.username, user %></td>
        <td><%= link_to user.full_name, user %></td>
        <td><%= link_to user.institution.name, user.institution %></td>
      </tr>
  <% end %>
  </tbody>

</table>

<%= will_paginate %>
