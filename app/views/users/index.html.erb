<% provide(:title, 'Users') %>

<% if current_user.is_admin? %>
    <ol class="breadcrumb">
      <li class="active">Users</li>
    </ol>
<% end %>

<h1>Users</h1>

<%= will_paginate %>

<table class="table table-striped table-hover">
  <thead>
  <tr>
    <th></th>
    <th></th>
    <th></th>
    <th></th>
    <th>Username</th>
    <th>Name</th>
    <th>Institution</th>
    <th>Confirmed</th>
    <th>Enabled</th>
  </tr>
  </thead>
  <tbody>
  <% @users.each do |user| %>
      <tr>
        <td>
          <% if current_user.is_admin? || current_user == user %>
              <%= link_to 'Edit', edit_user_path(user) %>
          <% end %>
        </td>
        <td>
          <% if current_user.is_admin? && !current_user?(user) %>
              <% if user.enabled %>
                  <%= link_to 'Disable', disable_user_path(user), method: :patch %>
              <% else %>
                  <%= link_to 'Enable', enable_user_path(user), method: :patch %>
              <% end %>
          <% end %>
        </td>
        <td>
          <% if current_user.is_admin? && !current_user?(user) %>
              <%= link_to 'Delete', user, method: :delete,
                          data: { confirm: 'Deleting this user will break all '\
                          'associations between the user and any institutions, '\
                          'locations, or assessments related to the user. It '\
                          'is recommended that inactive users be disabled, '\
                          'not deleted. Are you sure you want to delete this '\
                          'user?' } %>
          <% end %>
        </td>
        <td><%= gravatar_for user, size: 52 %></td>
        <td><%= link_to user.username, user %></td>
        <td><%= link_to user.full_name, user %></td>
        <td><%= user.institution ? user.institution.name : '' %></td>
        <td><%= user.confirmed ? 'Yes' : 'No' %></td>
        <td><%= user.enabled ? 'Yes' : 'No' %></td>
      </tr>
  <% end %>
  </tbody>

</table>

<%= will_paginate %>
