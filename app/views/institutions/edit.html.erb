<% provide(:title, "Edit #{@institution.name}") %>

<ol class="breadcrumb">
  <% if current_user.is_admin? %>
      <li><%= link_to 'Institutions', institutions_path %></li>
  <% end %>
  <li><%= link_to @institution.name, @institution %></li>
  <li class="active">Edit</li>
</ol>

<h1>Edit <%= @institution.name %></h1>

<div class="row" id="institution">

  <!-- left column menu -->
  <div class="col-sm-3">
    <nav>
      <ul class="nav nav-pills nav-stacked">
        <li class="active"><a href="#basic_info">Basic Info</a></li>
        <% @assessment_sections.each do |section| %>
            <li><a href="#<%= section.name.gsub(' ', '_') %>"><%= section.name %></a></li>
        <% end %>
      </ul>
    </nav>
  </div>

  <div class="col-sm-9 tab-content">

    <div id="basic_info" class="tab-pane active">
      <h2>Basic Info</h2>

      <%= form_for(@institution) do |f| %>
          <%= render 'shared/error_messages', :object => f.object %>

          <div class="form-group has-feedback">
            <%= f.label :name %>
            <%= f.text_field :name, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :description %>
            <%= f.text_area :description, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :email %>
            <%= f.email_field :email, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :url, 'URL' %>
            <%= f.url_field :url, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :address1, 'Address 1' %>
            <%= f.text_field :address1, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :address2, 'Address 2' %>
            <%= f.text_field :address2, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :city %>
            <%= f.text_field :city, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :state %>
            <%= f.text_field :state, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group has-feedback">
            <%= f.label :postal_code %>
            <%= f.text_field :postal_code, class: 'form-control' %>
            <span class="glyphicon form-control-feedback"></span>
          </div>

          <div class="form-group">
            <%= f.label :country %>
            <%= select('institution', 'country', countries_for_select,
                       { include_blank: false },
                       { class: 'form-control' }) %>
          </div>

          <div class="form-group">
            <%= f.label :language %>
            <%= f.collection_select :language_id, Language.all, :id, :english_name,
                                    { include_blank: true },
                                    { class: 'form-control' } %>
          </div>
          <%= f.submit 'Save Changes to This Section', class: 'btn btn-primary' %>
      <% end %>

    </div>

    <% @assessment_sections.each do |section| %>
        <div id="<%= section.name.gsub(' ', '_') %>" class="tab-pane">
          <h2><%= section.name %></h2>
          <p><%= section.description %></p>
          <%= form_for(@institution) do |f| %>
              <%= render partial: 'shared/question_tree_rows',
                         locals: {f: f,
                                  entity: @institution,
                                  children: section.assessment_questions.where(parent_id: nil).order(:index),
                                  depth: 0} %>
          <% end %>
        </div>
    <% end %>

  </div>

</div> <!-- .row #institution -->
