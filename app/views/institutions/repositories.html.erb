<%= render layout: 'institutions/layout' do %>

  <%= hidden_field_tag(:subpage, 'repositories') %>
  <%= hidden_field_tag(:new_repository_url, new_institution_repository_url(@institution)) %>

  <!-- Add Repository button -->
  <div style="text-align:right">
    <button type="button" class="btn btn-success" data-toggle="modal"
            data-target="#psap-create-panel">
      <%= entity_icon(Repository) %>
      Add Repository
    </button>
  </div>

  <% if @repositories.any? %>
    <div id="repositories">
      <ul class="psap-entity-list">
        <% @repositories.each do |repository| %>
          <li>
            <span class="title">
              <%= entity_icon(repository) %>
              <%= link_to repository.name, repository %>
            </span>
            <small>
              <%= entity_icon(Location, pluralize(repository.locations.count, 'location')) %>
              <%= repository.locations.count %>

              <%= entity_icon(Resource, pluralize(repository.resources.count, 'resource')) %>
              <%= repository.resources.count %>
            </small>
          </li>
        <% end %>
      </ul>

      <div class="text-center">
        <%= will_paginate @repositories, renderer: BootstrapPagination::Rails %>
      </div>

    </div>
  <% else %>
    <p>This institution has no repositories.</p>
  <% end %>

<% end %>
