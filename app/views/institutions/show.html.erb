<% provide(:title, @institution.name) %>

<ol class="breadcrumb">
  <% if current_user.is_admin? %>
      <li><%= link_to 'Institutions', institutions_path %></li>
  <% end %>
  <li class="active"><%= @institution.name %></li>
</ol>

<h1><%= @institution.name %></h1>

<% if @institution.repositories.any? %>

    <table class="table table-striped table-hover">
      <caption>Repositories</caption>
      <thead>
        <th></th>
        <th></th>
        <th></th>
      </thead>
      <tbody>
        <% @institution.repositories.each do |repository| %>
          <tr>
            <td>
              <% if current_user.has_permission?('repositories.edit_own') %>
                  <%= link_to 'Edit', edit_repository_path(repository) %>
              <% end %>
            </td>
            <td>
              <% if current_user.has_permission?('repositories.delete_own') %>
                  <%= link_to 'Delete', repository, method: :delete,
                              data: { confirm: 'Are you sure?' } %>
              <% end %>
            </td>
            <td><%= link_to repository.name, repository %></td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <p><%= link_to 'Add repository', new_institution_repository_path(@institution) %></p>

<% else %>

    <p>This institution has no repositories.
      <%= link_to '(Add one?)', new_institution_repository_path(@institution) %></p>

<% end %>
